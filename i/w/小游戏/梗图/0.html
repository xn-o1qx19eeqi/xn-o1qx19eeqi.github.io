---
layout: e0
permalink: 梗图
BeiJing: 0
BeiJing_SJ: 0
BiaoTi: 梗图
div0: 1
---
<script src="/i/5/new_html2canvas.js"></script>
<style>
    .按钮{margin:auto 0.6em;line-height:2em;padding:2px 6px;border:1.4px solid #bcbcbc;border-radius:6px;cursor:pointer}
    .按钮:hover{border:1.4px solid #0084ff;}
    #dy{position:relative;}
    #dy img{position:absolute;top:0;left:0;}
</style>


<style id="st"></style>
<div id="目录"></div><br>
<div id="dy_头"></div><br>
<div id="dy"></div>
<div id="dy_尾"></div>

<script>
let 测试="/i/w/小游戏/梗图/";
// 测试="";
let 目录=[];
let d={
    "目录":["目录","点点结局","兄弟，像素点不错","This is Fine","猫球UFO","旋转像素点",
        "<br>分类：","可能引发不适"],
    "可能引发不适":["目录","蘑菇乐园"],

    /*

    "":["目录","标题1","标题2","<span>文字"],
    
    "":["#点1{position:relative;width:154px;height:146px;top:248px;left:322px;background-color:#【1】}#dy{width:图片宽度px;height:图片高度px}",[
            ["1","默认","提示文字"],     // "默认"为："点"是用户默认像素点颜色 / "描边"是像素点描边色
            "直接显示文字，记得加<br>",
            "确定",                      //点击确定按钮
            "/",                         //后面的是 dy_尾
            "保存图片",
    ],
    "1.png","<div id='点'></div>","2.png"] //内容可以是.jpg 或 <div>其他元素</div>

    图片名=标题 如果标题有空格，文件要删掉空格

    */

    "点点结局":["#点{position:relative;width:96px;height:92px;top:155px;left:201px;background-color:#【1】}#dy{width:500px;height:500px}",[["1","点","像素点编号"],"确定","/","保存图片"],"<div id='点'></div>",".jpg"],
    "兄弟，像素点不错":["#点{position:relative;width:122px;height:122px;top:346px;left:398px;background-color:#【1】}#dy{width:583px;height:508px}",[["1","点","像素点编号"],"确定","/","保存图片"],".png","<div id='点'></div>"],
    "This is Fine":["#点{position:relative;width:118px;height:121px;top:248px;left:176px;background-color:#【1】}#dy{width:500px;height:509px}",["<small>素材来源：K.C.Green «Gunshow»</small><br>",["1","点","像素点编号"],"确定","/","保存图片"],"1.png","<div id='点'></div>","2.png"],
    "蘑菇乐园":["#点{position:relative;width:113px;height:113px;top:514px;left:473px;background-color:#【1】}#dy{width:1000px;height:667px}",[["1","点","像素点编号"],"确定","/","保存图片"],"<div id='点'></div>",".jpg"],
    "猫球UFO":["#点{position:relative;width:190px;height:190px;top:570px;left:145px;background-color:#【1】}#dy{width:600px;height:956px}",["<small>作者：莱斯哈耶</small><br>",["1","点","像素点编号"],"确定","/","保存图片"],".png","<div id='点'></div>"],



    "旋转像素点":["#背景{background-color:#03FF2D;width:800px;height:500px;display:flex;justify-content:center;align-items:center;margin:0;perspective:1200px}.cube{position:relative;width:200px;height:200px;transform-style:preserve-3d;animation:spinAndFloat 4s linear infinite}.face{position:absolute;width:100%;height:100%;opacity:1;background:#【1】;border:2px solid #【2】}.front{transform:translateZ(100px)}.back{transform:rotateY(180deg) translateZ(100px)}.right{transform:rotateY(90deg) translateZ(100px)}.left{transform:rotateY(-90deg) translateZ(100px)}.top{transform:rotateX(90deg) translateZ(100px)}.bottom{transform:rotateX(-90deg) translateZ(100px)}@keyframes spinAndFloat{0%,50%{transform:scale(1.1) translateY(0) rotateY(0);animation-timing-function:ease-in}51%{transform:scale(0.8) translateY(0)}70%{transform:scale(0.8) translateY(-40px) rotateY(720deg)}90%{transform:scale(0.8) translateY(20px) rotateY(1080deg)}100%{transform:scale(0.8) translateY(0) rotateY(1440deg)}}#dy{width:600px;height:956px}",[["1","点","像素点编号"],["2","描边","描边颜色"],"确定"],"<div id='背景'><div class='cube'><div class='face front'></div><div class='face back'></div><div class='face right'></div><div class='face left'></div><div class='face top'></div><div class='face bottom'></div></div></div>"],




    
}

let 点数,输入;
let 颜色=localStorage.getItem("像素点")||"000000";
let 描边=localStorage.getItem("像素点描边")||"FFFFFF";
function 打开(o){
    点数=[o],输入={0:d[o][0]};
    目录=d[o];
    if(目录[0]=="目录"){
        let dy="";
        for(let i=0;目录.length>i;i++){if(i==0&&o=="目录"){}else if(目录[i][0]=="<"){dy+=目录[i]}else{
            if(d[目录[i]][0]=="目录"){dy+="<span class='按钮' onclick=\"打开('"+目录[i]+"')\"><b>"+目录[i]+"</b></span>"}
            else{dy+="<span class='按钮' onclick=\"打开('"+目录[i]+"')\">"+目录[i]+"</span>"}
        }
        }
        document.getElementById("目录").innerHTML=dy;
    }else{
        let dy="";
        for(let i=d[o].length-1;i>1;i--){
            if(d[o][i].endsWith(".jpg")||d[o][i].endsWith(".png")||d[o][i].endsWith(".gif")){
                dy+="<img src='"+测试+o.replace(new RegExp(' ',"g"),"")+d[o][i]+"'>";
            }else{
                dy+=d[o][i];
            }
        }
        document.getElementById("dy").innerHTML=dy;

        dy=[""];

        for(let i=0;d[o][1].length>i;i++){
            if(Array.isArray(d[o][1][i])){
                点数[点数.length]=d[o][1][i][0];
                dy[dy.length-1]+="<input type='text' placeholder='"+d[o][1][i][2]+"' autocomplete='off' id='输入"+d[o][1][i][0]+"'>";
                if(d[o][1][i][1]=="点"){d[o][1][i][1]=颜色}
                if(d[o][1][i][1]=="描边"){d[o][1][i][1]=描边}
                输入[d[o][1][i][0]]=d[o][1][i][1];
            }else{
                if(d[o][1][i]=="/"){
                    dy[1]="";
                }else if(d[o][1][i]=="保存图片"){
                    dy[dy.length-1]+="<a onclick='截图()'>保存图片</a>"
                }else if(d[o][1][i]=="确定"){
                    dy[dy.length-1]+="<br><a onclick='确定()'>确定</a>";
                }else{
                    dy[dy.length-1]+=d[o][1][i];
                }
            }
        }
        document.getElementById("dy_头").innerHTML=dy[0];
        if(dy[1]){
            document.getElementById("dy_尾").innerHTML=dy[1];
        }
        
        dy=d[o][0];
        for(let i=1;点数.length>i;i++){
            dy=dy.replace(new RegExp('【'+点数[i]+'】',"g"),输入[i])
        }
        document.getElementById("st").innerHTML=dy;
    }
}

function 确定(){
    let dy=输入[0];
    for(let i=1;点数.length>i;i++){
        输入[i]=document.getElementById("输入"+i).value;
        dy=dy.replace(new RegExp('【'+点数[i]+'】',"g"),输入[i])
    }
    document.getElementById("st").innerHTML=dy;
}

let url=location.href;
if(url.indexOf("?")!=-1){url=url.split("?")[1]}
else{url="目录"}
打开(url);

function 截图(){
    const element = document.getElementById('dy');
    const devicePixelRatio = window.devicePixelRatio || 1;
    const scale = Math.min(2, devicePixelRatio);

    const options = {
        logging: true,
        useCORS: true,
        allowTaint: false,
        scale: scale,
        width: element.offsetWidth,
        height: element.offsetHeight,
        backgroundColor: null,
        onclone: (clonedDoc) => {
            const cloneElement = clonedDoc.getElementById('dy');
            if (cloneElement) {
                cloneElement.style.cssText += `
                    transform: translateZ(0) !important; /* 强制GPU渲染 */
                    image-rendering: -webkit-optimize-contrast !important;
                    text-rendering: optimizeLegibility !important;
                `;
            }
        }
    };

    html2canvas(element, options).then(canvas => {
        const ctx = canvas.getContext('2d');
        ctx.imageSmoothingEnabled = false;
        ctx.mozImageSmoothingEnabled = false;
        ctx.webkitImageSmoothingEnabled = false;
        const imgData = canvas.toDataURL('image/png',1.0);
    
        const link = document.createElement('a');
        const formattedDateTime = ((d) => `${d.getFullYear()}${(d.getMonth()+1+'').padStart(2,'0')}${(d.getDate()+'').padStart(2,'0')} ${d.getHours().toString().padStart(2,'0')}${d.getMinutes().toString().padStart(2,'0')}${d.getSeconds().toString().padStart(2,'0')}`)(new Date())
        link.download = formattedDateTime +'.png';
        link.href = imgData;
    
        link.click();
        URL.revokeObjectURL(link.href);
    }).catch(error => {
        try{notyf.alert("存图失败");}catch(e){alert("存图失败");}
    });
};

</script>

