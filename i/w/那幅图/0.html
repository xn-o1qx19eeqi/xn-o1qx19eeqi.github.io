---
layout: e0
permalink: nft
BeiJing: 0／0-01.png
BeiJing_SJ: 0／0-01.png
BiaoTi: 那幅图
div0: 1
---
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>

<style>
    sup[S]:before{content:" S";color:#ffc800;font-weight:bold}sup[A]:before{content:" A";color:#d229db}sup[B]:before{content:" B";color:#2977DB}sup[C]:before{content:" C";color:#1456ad}sup[EX]:before{content:" EX";color:#1ff434}
</style>

<div id="房子"></div>
<div id="元素"></div>

<a onclick="capture()">保存截图</a>

<script>
let dz=location.href.split("?")[1];

let w={
    "ceshi":"#房子{width:400px;height:400px}#房子 img{width:400px;height:400px;position:absolute;top:0;left:0}#点点{position:relative;width:160px;height:160px;top:160px;left:120px}",
}


try{
    let q="/i/w/那幅图/";
    let 地址=q+"0/"+dz+".json";
    let GetJson=$.ajax({
        url:地址,
        type:"GET",
        dataType:"json",
        async:false,
        success:function(data){
        }
    });
    地址=GetJson.responseJSON;

    q=q+地址["w"]+"/";

    let dy1="<style>"+w[地址["w"]]+"</style>";
    let dy2="";
    for(let i=0;地址["q"].length>i;i++){
        dy1+="<img src='"+q+地址["q"][i][0]+"."+地址["q"][i][1]+"'>";
        dy2+=地址["q"][i][0]+"<sup "+地址["q"][i][2]+"></sup>"+"　";
    }
    dy1+="<div id='点点' style='background-color:#"+地址["x"]+"'></div>"
    for(let i=0;地址["e"].length>i;i++){
        dy1+="<img src='"+q+地址["e"][i][0]+"."+地址["e"][i][1]+"'>";
        dy2+=地址["e"][i][0]+"<sup "+地址["e"][i][2]+"></sup>"+"　";
    }
    document.getElementById("房子").innerHTML=dy1;
    document.getElementById("元素").innerHTML="<b><small>像素点编号：</small></b><a href='/"+地址["x"]+"'>"+地址["x"]+"</a><br><b><small>元素：</small></b>"+dy2;

    }catch(e){
    notyf.alert("失败，代码有误或网络故障");
}

function capture(){
    const canvasID = document.getElementById("房子");
    const rect=canvasID.getBoundingClientRect()
  html2canvas(document.querySelector("#房子"),{
    scale: 1, // 数值越大生成的图片越清晰
    useCORS: true,
    allowTaint: true,
    y: 0, // 滚动条高度修复
    x: 0,
    allowTaint: true, //开启跨域
    useCORS: true,
    scrollX: 0,
    scrollY: rect.top, // 关键代码
    height: rect.height, // 加高度，避免截取不全
  }).then(canvas=>{
    let img=canvas.toDataURL("image/png");

    let a=document.createElement("a");
    a.href=img;
    a.download=dz+".png";
    a.click();
  });
}


</script>


